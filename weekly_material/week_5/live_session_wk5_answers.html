<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Live Session - Week 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="live_session_wk5_answers_files/libs/clipboard/clipboard.min.js"></script>
<script src="live_session_wk5_answers_files/libs/quarto-html/quarto.js"></script>
<script src="live_session_wk5_answers_files/libs/quarto-html/popper.min.js"></script>
<script src="live_session_wk5_answers_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="live_session_wk5_answers_files/libs/quarto-html/anchor.min.js"></script>
<link href="live_session_wk5_answers_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="live_session_wk5_answers_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="live_session_wk5_answers_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="live_session_wk5_answers_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="live_session_wk5_answers_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Live Session - Week 5</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="live-session---week-5" class="level2">
<h2 class="anchored" data-anchor-id="live-session---week-5">Live Session - Week 5</h2>
<p>Goals:</p>
<ul>
<li><p>Project</p>
<ul>
<li><p>Overview</p></li>
<li><p>Strategies for collaboration</p></li>
</ul></li>
<li><p>Tidying data exercise</p></li>
</ul>
</section>
<section id="project" class="level2">
<h2 class="anchored" data-anchor-id="project">Project</h2>
<ul>
<li><p>Overview</p>
<ul>
<li><p>Goals are:</p>
<ul>
<li><p>work collaboratively on a “real-life” question</p></li>
<li><p>use what you have learned to translate data into something that guides decision-making and action</p></li>
</ul></li>
<li><p>Scenarios</p>
<ul>
<li><p>Each utilize 3+ publicly available datasets to answer a question</p></li>
<li><p>Require cleaning, aggregating, and creating new fields</p></li>
<li><p>Each will have some specific instructions pertaining to cleaning and new variables, but there is also room for creativity and choosing data elements of interest</p></li>
<li><p>No statistical testing is required, focus is more on the data tidying</p></li>
</ul></li>
<li><p>Milestones</p>
<ol type="1">
<li>Create group repository and choose scenario (9/25)</li>
<li>Import data into R and explore it (due 10/2)</li>
<li>Tidy your 3+ datasets and create new variables (due 11/6)</li>
<li>Join datasets and create visualizations (due 11/20)</li>
<li>Optional draft of final report for input (due 11/27)</li>
<li>Final product published on rpubs (due 12/10)</li>
</ol></li>
</ul></li>
<li><p>Collaboration techniques</p>
<ul>
<li><p>Github does not work as seamlessly as Google Docs, and it is possible to have a “merge conflict” when multiple people are working on same script</p>
<ul>
<li><p>If this happens, do not panic! We will provide instructions to resolve.</p></li>
<li><p>Leave extra time before deadlines in case this happens</p></li>
</ul></li>
<li><p>How to avoid merge conflicts?</p>
<ul>
<li><p>‘Pull’ from repo when you log on to start working &amp; ‘Push’ when you are done for the day (even if work is still in-progress)</p></li>
<li><p>Coordinate with other team members around when you are working on the project</p></li>
<li><p>If working at the same time as someone else, work on different parts of the same file</p>
<ul>
<li>Conflicts often happen when working in the same area of a script, or if two people both add something to the end</li>
</ul></li>
</ul></li>
<li><p>General strategies</p>
<ul>
<li><p>Communication is key</p></li>
<li><p>Work off a well-organized Qmd/Rmd - have a chunk for each step and name each chunk (ex: setup, import_df1, import_df2, etc); have each group member work on different chunks</p></li>
<li><p>Utilize “sandbox” scripts for each team member to develop and test code before adding to the shared script</p></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lauren will work on things in this chunk</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Maddy will work on things in this chunk</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-tidying-data" class="level2">
<h2 class="anchored" data-anchor-id="exercise-tidying-data">Exercise: Tidying data</h2>
<section id="loading-in-tidyverse-library" class="level5">
<h5 class="anchored" data-anchor-id="loading-in-tidyverse-library">Loading in tidyverse library</h5>
<p><strong>Note:</strong> the <strong>tidyverse</strong> package includes all of the <strong>dplyr</strong>, <strong>tibble</strong>, <strong>ggplot2</strong>, <strong>forcats</strong>, <strong>stringr</strong>, <strong>readr</strong>, <strong>purr</strong>, and <strong>tidyr</strong> packages. Therefore, you will not need to call those individual packages if you call in the tidyverse package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="importing-a-file" class="level4">
<h4 class="anchored" data-anchor-id="importing-a-file">Importing a file</h4>
<p>Import a dataset from the California Health and Human Services Open Data Portal (CHHS ODP) on COVID vaccination. The primary purpose of the CHHS ODP is to collect health related data in California and to make this information available to the public.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a file path to directly import a csv from the internet</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import full file to see what it looks like</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>vaccine_full <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 71300 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (2): county, california_flag
dbl  (10): total_doses, cumulative_total_doses, partially_vaccinated, total_...
date  (1): administered_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="quick-exploration" class="level4">
<h4 class="anchored" data-anchor-id="quick-exploration">Quick exploration</h4>
<ul>
<li><p>Structure of dataset/table</p></li>
<li><p>Unique county names</p></li>
<li><p>Distribution of dates reported</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first 6 rows of the dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vaccine_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  county  administered_date total_doses cumulative_total_doses
  &lt;chr&gt;   &lt;date&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;
1 Alameda 2020-01-05                  0                      0
2 Alameda 2020-07-27                  0                      0
3 Alameda 2020-07-29                  0                      1
4 Alameda 2020-07-30                  0                      1
5 Alameda 2020-07-31                  0                      1
6 Alameda 2020-08-02                  0                      2
# ℹ 9 more variables: partially_vaccinated &lt;dbl&gt;,
#   total_partially_vaccinated &lt;dbl&gt;, fully_vaccinated &lt;dbl&gt;,
#   cumulative_fully_vaccinated &lt;dbl&gt;, at_least_one_dose &lt;dbl&gt;,
#   cumulative_at_least_one_dose &lt;dbl&gt;, california_flag &lt;chr&gt;,
#   up_to_date_count &lt;dbl&gt;, cumulative_up_to_date_count &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># structure of dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(vaccine_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [71,300 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ county                      : chr [1:71300] "Alameda" "Alameda" "Alameda" "Alameda" ...
 $ administered_date           : Date[1:71300], format: "2020-01-05" "2020-07-27" ...
 $ total_doses                 : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ cumulative_total_doses      : num [1:71300] 0 0 1 1 1 2 2 3 3 3 ...
 $ partially_vaccinated        : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ total_partially_vaccinated  : num [1:71300] 0 0 1 1 1 2 2 3 3 3 ...
 $ fully_vaccinated            : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ cumulative_fully_vaccinated : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ at_least_one_dose           : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ cumulative_at_least_one_dose: num [1:71300] 0 0 1 1 1 2 2 3 3 3 ...
 $ california_flag             : chr [1:71300] NA NA NA NA ...
 $ up_to_date_count            : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 $ cumulative_up_to_date_count : num [1:71300] 0 0 0 0 0 0 0 0 0 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   county = col_character(),
  ..   administered_date = col_date(format = ""),
  ..   total_doses = col_double(),
  ..   cumulative_total_doses = col_double(),
  ..   partially_vaccinated = col_double(),
  ..   total_partially_vaccinated = col_double(),
  ..   fully_vaccinated = col_double(),
  ..   cumulative_fully_vaccinated = col_double(),
  ..   at_least_one_dose = col_double(),
  ..   cumulative_at_least_one_dose = col_double(),
  ..   california_flag = col_character(),
  ..   up_to_date_count = col_double(),
  ..   cumulative_up_to_date_count = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique county names - returns a list of values </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(vaccine_full<span class="sc">$</span>county)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Alameda"                    "All CA Counties"           
 [3] "All CA and Non-CA Counties" "Alpine"                    
 [5] "Amador"                     "Butte"                     
 [7] "Calaveras"                  "Colusa"                    
 [9] "Contra Costa"               "Del Norte"                 
[11] "El Dorado"                  "Fresno"                    
[13] "Glenn"                      "Humboldt"                  
[15] "Imperial"                   "Inyo"                      
[17] "Kern"                       "Kings"                     
[19] "Lake"                       "Lassen"                    
[21] "Los Angeles"                "Madera"                    
[23] "Marin"                      "Mariposa"                  
[25] "Mendocino"                  "Merced"                    
[27] "Modoc"                      "Mono"                      
[29] "Monterey"                   "Napa"                      
[31] "Nevada"                     "Orange"                    
[33] "Outside California"         "Placer"                    
[35] "Plumas"                     "Riverside"                 
[37] "Sacramento"                 "San Benito"                
[39] "San Bernardino"             "San Diego"                 
[41] "San Francisco"              "San Joaquin"               
[43] "San Luis Obispo"            "San Mateo"                 
[45] "Santa Barbara"              "Santa Clara"               
[47] "Santa Cruz"                 "Shasta"                    
[49] "Sierra"                     "Siskiyou"                  
[51] "Solano"                     "Sonoma"                    
[53] "Stanislaus"                 "Sutter"                    
[55] "Tehama"                     "Trinity"                   
[57] "Tulare"                     "Tuolumne"                  
[59] "Unknown"                    "Ventura"                   
[61] "Yolo"                       "Yuba"                      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(vaccine_full<span class="sc">$</span>california_flag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA                  "Not in California" "California"       </code></pre>
</div>
</div>
<p>After taking a closer look at the raw data and seeing that it is a very large dataset, we decide that we only need to keep columns that are important for our analysis because it is a best practice to only use the data that you need. Using minimally necessary data speeds up data processing because it takes up less memory storage.</p>
</section>
<section id="tidying-columns-questions-1-2-3" class="level4">
<h4 class="anchored" data-anchor-id="tidying-columns-questions-1-2-3">TIDYING COLUMNS (QUESTIONS 1, 2, &amp; 3)</h4>
<p>We’d like this dataset to only include the following columns:</p>
<ul>
<li><p>county - character</p></li>
<li><p>cumulative_fully_vaccinated - double [completed primary series]</p></li>
<li><p>cumulative_up_to_date_count - double [received an updated vaccine based on CDC recommendations]</p></li>
<li><p>administered_date - date</p></li>
</ul>
<section id="question-1" class="level5">
<h5 class="anchored" data-anchor-id="question-1">Question 1</h5>
<p>Select the columns listed above using methods/functions from <strong>Base R</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subsetting columns using Base R</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>vaccine_columns_1 <span class="ot">&lt;-</span> vaccine_full[ ,<span class="fu">c</span>(<span class="st">"county"</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"cumulative_fully_vaccinated"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"cumulative_up_to_date_count"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"administered_date"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-2" class="level5">
<h5 class="anchored" data-anchor-id="question-2">Question 2</h5>
<p>After subsetting your columns using Base R, try using <strong>tidyverse</strong> code to subset your columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subsetting columns using dplyr</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vaccine_columns_2 <span class="ot">&lt;-</span> <span class="fu">select</span>(vaccine_full, <span class="fu">c</span>(<span class="st">"county"</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"cumulative_fully_vaccinated"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"cumulative_up_to_date_count"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"administered_date"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-3-bonus" class="level5">
<h5 class="anchored" data-anchor-id="question-3-bonus">Question 3 (BONUS)</h5>
<p>One other way of subsetting the columns in your dataset is by doing this <em>during</em> the initial import step. Try to import the file, however this time only import the following columns and ensure they are the corresponding data types:</p>
<ul>
<li><p>county - character</p></li>
<li><p>cumulative_fully_vaccinated - double</p></li>
<li><p>cumulative_up_to_date_count - double</p></li>
<li><p>administered_date - date</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import only the columns we need</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vaccine_columns_3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  file_path,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols_only</span>(<span class="at">county =</span> <span class="fu">col_character</span>(), </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumulative_fully_vaccinated =</span> <span class="fu">col_double</span>(), </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cumulative_up_to_date_count =</span> <span class="fu">col_double</span>(), </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">administered_date =</span> <span class="fu">col_date</span>()))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#the below also works</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># vaccine_columns_3 &lt;- read_csv(</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   file_path,</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   col_select = c("county", </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#            "cumulative_fully_vaccinated", </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#            "cumulative_up_to_date_count", </span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#            "administered_date"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="tidying-rows-questions-4-5-6" class="level4">
<h4 class="anchored" data-anchor-id="tidying-rows-questions-4-5-6"><strong>TIDYING ROWS (QUESTIONS 4, 5, &amp; 6)</strong></h4>
<p>Once we have limited the amount of columns in our data set, we now want to subset the rows as well. Therefore your task will be to create a subset with:</p>
<ul>
<li><p>Only most recent records for vaccinations</p></li>
<li><p>Only Southern California Counties (Los Angeles, Orange, Santa Barbara, Ventura, San Bernardino, Kern, San Luis Obispo, Imperial, Riverside, San Diego)</p></li>
</ul>
<p><em>Note:</em> You can use any one of the vaccine_columns_1, vaccine_columns_2, and vaccine_columns_3 as your starting dataframe. The resulting data frame will be the same.</p>
<section id="question-4" class="level5">
<h5 class="anchored" data-anchor-id="question-4">Question 4</h5>
<p>Create a new object with the date cutoff and a new vector of county names. Then subset the dataset by date and county using <strong>Base R</strong>. Reference the date object and county vector in the subset step. <em>Hint:</em> the which() function may be important.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>date_cutoff <span class="ot">&lt;-</span> <span class="fu">max</span>(vaccine_columns_1<span class="sc">$</span>administered_date, <span class="at">na.rm=</span>T)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Los Angeles"</span>,<span class="st">"Orange"</span>,<span class="st">"Santa Barbara"</span>, <span class="st">"Ventura"</span>, <span class="st">"San Bernardino"</span>,<span class="st">"Kern"</span>,<span class="st">"San Luis Obispo"</span>, <span class="st">"Imperial"</span>, <span class="st">"Riverside"</span>, <span class="st">"San Diego"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1: which</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>vaccine_rows_1 <span class="ot">&lt;-</span> vaccine_columns_1[<span class="fu">which</span>(vaccine_columns_1<span class="sc">$</span>county <span class="sc">%in%</span> counties <span class="sc">&amp;</span> vaccine_columns_1<span class="sc">$</span>administered_date <span class="sc">==</span> date_cutoff), ]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>vaccine_rows_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   county        cumulative_fully_vac…¹ cumulative_up_to_dat…² administered_date
   &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt; &lt;date&gt;           
 1 San Luis Obi…                 186280                  60940 2023-09-18       
 2 Imperial                      181682                  37614 2023-09-18       
 3 Kern                          496949                  78610 2023-09-18       
 4 Los Angeles                  7560208                2083804 2023-09-18       
 5 Orange                       2374913                 641836 2023-09-18       
 6 Riverside                    1497473                 320734 2023-09-18       
 7 San Bernardi…                1277210                 256053 2023-09-18       
 8 San Diego                    2568993                 777629 2023-09-18       
 9 Santa Barbara                 317979                  91305 2023-09-18       
10 Ventura                       626090                 169935 2023-09-18       
# ℹ abbreviated names: ¹​cumulative_fully_vaccinated,
#   ²​cumulative_up_to_date_count</code></pre>
</div>
</div>
</section>
<section id="question-5" class="level5">
<h5 class="anchored" data-anchor-id="question-5">Question 5</h5>
<p>Subset the dataset using the <strong>subset</strong> function. <em>Hint:</em> Copy the code from Question 4 and change code accordingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2: subset function</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>vaccine_rows_2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(vaccine_columns_1, county <span class="sc">%in%</span> counties <span class="sc">&amp;</span> administered_date<span class="sc">==</span> date_cutoff)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>vaccine_rows_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   county        cumulative_fully_vac…¹ cumulative_up_to_dat…² administered_date
   &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt; &lt;date&gt;           
 1 San Luis Obi…                 186280                  60940 2023-09-18       
 2 Imperial                      181682                  37614 2023-09-18       
 3 Kern                          496949                  78610 2023-09-18       
 4 Los Angeles                  7560208                2083804 2023-09-18       
 5 Orange                       2374913                 641836 2023-09-18       
 6 Riverside                    1497473                 320734 2023-09-18       
 7 San Bernardi…                1277210                 256053 2023-09-18       
 8 San Diego                    2568993                 777629 2023-09-18       
 9 Santa Barbara                 317979                  91305 2023-09-18       
10 Ventura                       626090                 169935 2023-09-18       
# ℹ abbreviated names: ¹​cumulative_fully_vaccinated,
#   ²​cumulative_up_to_date_count</code></pre>
</div>
</div>
</section>
<section id="question-6" class="level5">
<h5 class="anchored" data-anchor-id="question-6">Question 6</h5>
<p>Subset the dataset using a <strong>dplyr</strong> function. <em>Hint:</em> Copy the code from Question 5 and change code accordingly (the only difference should be the function itself).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 3: filter function (tidyverse - dplyr)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>vaccine_rows_3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(vaccine_columns_1, county <span class="sc">%in%</span> counties <span class="sc">&amp;</span> administered_date<span class="sc">==</span>date_cutoff) </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>vaccine_rows_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   county        cumulative_fully_vac…¹ cumulative_up_to_dat…² administered_date
   &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt; &lt;date&gt;           
 1 San Luis Obi…                 186280                  60940 2023-09-18       
 2 Imperial                      181682                  37614 2023-09-18       
 3 Kern                          496949                  78610 2023-09-18       
 4 Los Angeles                  7560208                2083804 2023-09-18       
 5 Orange                       2374913                 641836 2023-09-18       
 6 Riverside                    1497473                 320734 2023-09-18       
 7 San Bernardi…                1277210                 256053 2023-09-18       
 8 San Diego                    2568993                 777629 2023-09-18       
 9 Santa Barbara                 317979                  91305 2023-09-18       
10 Ventura                       626090                 169935 2023-09-18       
# ℹ abbreviated names: ¹​cumulative_fully_vaccinated,
#   ²​cumulative_up_to_date_count</code></pre>
</div>
</div>
</section>
</section>
<section id="renaming-creating-and-reordering-columns-and-integrating-an-if-else-statement-questions-7-8-9-10" class="level4">
<h4 class="anchored" data-anchor-id="renaming-creating-and-reordering-columns-and-integrating-an-if-else-statement-questions-7-8-9-10">RENAMING, CREATING, AND REORDERING COLUMNS AND INTEGRATING AN IF ELSE STATEMENT (QUESTIONS 7, 8, 9, 10)</h4>
<section id="question-7" class="level5">
<h5 class="anchored" data-anchor-id="question-7">Question 7</h5>
<p>Now that we have limited our data set to 10 rows and 4 variables, rename the following columns names using a <strong>dplyr</strong> function:</p>
<ul>
<li><p>“cumulative_fully_vaccinated” to “primary_series”</p></li>
<li><p>“cumulative_up_to_date_count” to “up_to_date”</p></li>
</ul>
<p><em>Note:</em> you can use vaccine_rows_1, vaccine_rows_2, or vaccine_rows_3 as your starting data frame</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>vaccine_rename <span class="ot">&lt;-</span> <span class="fu">rename</span>(vaccine_rows_1, <span class="at">primary_series=</span> cumulative_fully_vaccinated, <span class="at">up_to_date=</span> cumulative_up_to_date_count)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>vaccine_rename</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   county          primary_series up_to_date administered_date
   &lt;chr&gt;                    &lt;dbl&gt;      &lt;dbl&gt; &lt;date&gt;           
 1 San Luis Obispo         186280      60940 2023-09-18       
 2 Imperial                181682      37614 2023-09-18       
 3 Kern                    496949      78610 2023-09-18       
 4 Los Angeles            7560208    2083804 2023-09-18       
 5 Orange                 2374913     641836 2023-09-18       
 6 Riverside              1497473     320734 2023-09-18       
 7 San Bernardino         1277210     256053 2023-09-18       
 8 San Diego              2568993     777629 2023-09-18       
 9 Santa Barbara           317979      91305 2023-09-18       
10 Ventura                 626090     169935 2023-09-18       </code></pre>
</div>
</div>
</section>
<section id="question-8" class="level5">
<h5 class="anchored" data-anchor-id="question-8">Question 8</h5>
<p>Create a new column using a <strong>dplyr</strong> function called <em>perc_up_to_date</em> that contains the percent of the population with a primary series that is also up-to-date on additional doses. Round to 2 decimal places.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>vaccine_perc <span class="ot">&lt;-</span> <span class="fu">mutate</span>(vaccine_rename, <span class="at">perc_up_to_date =</span> <span class="fu">round</span>((up_to_date<span class="sc">/</span>primary_series)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>vaccine_perc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   county          primary_series up_to_date administered_date perc_up_to_date
   &lt;chr&gt;                    &lt;dbl&gt;      &lt;dbl&gt; &lt;date&gt;                      &lt;dbl&gt;
 1 San Luis Obispo         186280      60940 2023-09-18                   32.7
 2 Imperial                181682      37614 2023-09-18                   20.7
 3 Kern                    496949      78610 2023-09-18                   15.8
 4 Los Angeles            7560208    2083804 2023-09-18                   27.6
 5 Orange                 2374913     641836 2023-09-18                   27.0
 6 Riverside              1497473     320734 2023-09-18                   21.4
 7 San Bernardino         1277210     256053 2023-09-18                   20.0
 8 San Diego              2568993     777629 2023-09-18                   30.3
 9 Santa Barbara           317979      91305 2023-09-18                   28.7
10 Ventura                 626090     169935 2023-09-18                   27.1</code></pre>
</div>
</div>
</section>
<section id="question-9" class="level5">
<h5 class="anchored" data-anchor-id="question-9">Question 9</h5>
<p>Use a <strong>dplyr</strong> function to assort dateframe in descending order based on the <em>perc_up_to_date</em> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>vaccine_arranged <span class="ot">&lt;-</span> <span class="fu">arrange</span>(vaccine_perc, <span class="fu">desc</span>(perc_up_to_date))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>vaccine_arranged</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   county          primary_series up_to_date administered_date perc_up_to_date
   &lt;chr&gt;                    &lt;dbl&gt;      &lt;dbl&gt; &lt;date&gt;                      &lt;dbl&gt;
 1 San Luis Obispo         186280      60940 2023-09-18                   32.7
 2 San Diego              2568993     777629 2023-09-18                   30.3
 3 Santa Barbara           317979      91305 2023-09-18                   28.7
 4 Los Angeles            7560208    2083804 2023-09-18                   27.6
 5 Ventura                 626090     169935 2023-09-18                   27.1
 6 Orange                 2374913     641836 2023-09-18                   27.0
 7 Riverside              1497473     320734 2023-09-18                   21.4
 8 Imperial                181682      37614 2023-09-18                   20.7
 9 San Bernardino         1277210     256053 2023-09-18                   20.0
10 Kern                    496949      78610 2023-09-18                   15.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>vaccine_arranged_2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(vaccine_perc, <span class="sc">-</span>(perc_up_to_date))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>vaccine_arranged_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   county          primary_series up_to_date administered_date perc_up_to_date
   &lt;chr&gt;                    &lt;dbl&gt;      &lt;dbl&gt; &lt;date&gt;                      &lt;dbl&gt;
 1 San Luis Obispo         186280      60940 2023-09-18                   32.7
 2 San Diego              2568993     777629 2023-09-18                   30.3
 3 Santa Barbara           317979      91305 2023-09-18                   28.7
 4 Los Angeles            7560208    2083804 2023-09-18                   27.6
 5 Ventura                 626090     169935 2023-09-18                   27.1
 6 Orange                 2374913     641836 2023-09-18                   27.0
 7 Riverside              1497473     320734 2023-09-18                   21.4
 8 Imperial                181682      37614 2023-09-18                   20.7
 9 San Bernardino         1277210     256053 2023-09-18                   20.0
10 Kern                    496949      78610 2023-09-18                   15.8</code></pre>
</div>
</div>
</section>
<section id="question-10" class="level5">
<h5 class="anchored" data-anchor-id="question-10">Question 10</h5>
<p>The goal for the state was to reach a level of 25% of the vaccinated population being up to date. Create a new column using a <strong>dplyr</strong> function called <em>goal_met</em> that indicates whether or not each county met the goals of the state using the <strong>if_else</strong> function. Use ‘Y’ to indicate that a level of 25% was reached and ‘N’ to indicate that it was not reached.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>vaccine_goal <span class="ot">&lt;-</span> <span class="fu">mutate</span>(vaccine_arranged, <span class="at">goal_met=</span><span class="fu">ifelse</span>(perc_up_to_date<span class="sc">&gt;</span><span class="dv">25</span>,<span class="st">"Y"</span>,<span class="st">"N"</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>vaccine_goal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   county   primary_series up_to_date administered_date perc_up_to_date goal_met
   &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt; &lt;date&gt;                      &lt;dbl&gt; &lt;chr&gt;   
 1 San Lui…         186280      60940 2023-09-18                   32.7 Y       
 2 San Die…        2568993     777629 2023-09-18                   30.3 Y       
 3 Santa B…         317979      91305 2023-09-18                   28.7 Y       
 4 Los Ang…        7560208    2083804 2023-09-18                   27.6 Y       
 5 Ventura          626090     169935 2023-09-18                   27.1 Y       
 6 Orange          2374913     641836 2023-09-18                   27.0 Y       
 7 Riversi…        1497473     320734 2023-09-18                   21.4 N       
 8 Imperial         181682      37614 2023-09-18                   20.7 N       
 9 San Ber…        1277210     256053 2023-09-18                   20.0 N       
10 Kern             496949      78610 2023-09-18                   15.8 N       </code></pre>
</div>
</div>
</section>
</section>
<section id="bonus-tidying-the-data-set-in-one-step" class="level4">
<h4 class="anchored" data-anchor-id="bonus-tidying-the-data-set-in-one-step">BONUS: TIDYING THE DATA SET IN ONE STEP</h4>
<section id="bonus" class="level5">
<h5 class="anchored" data-anchor-id="bonus">Bonus</h5>
<p>Perform all of the same tidying to arrive at the <em>vaccine_goal</em> dataframe in one step. Begin with the <em>vaccine_full</em> dataframe. Hint: You will only need to use dplyr functions and a pipe operator will be useful throughout.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>vaccine_goal_2 <span class="ot">&lt;-</span> vaccine_full <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, cumulative_fully_vaccinated, cumulative_up_to_date_count, administered_date) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(county <span class="sc">%in%</span> counties <span class="sc">&amp;</span> administered_date<span class="sc">==</span>date_cutoff) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">primary_series=</span> cumulative_fully_vaccinated, <span class="at">up_to_date=</span> cumulative_up_to_date_count) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">perc_up_to_date =</span> <span class="fu">round</span>((up_to_date<span class="sc">/</span>primary_series)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_up_to_date)) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">goal_met=</span><span class="fu">ifelse</span>(perc_up_to_date<span class="sc">&gt;</span><span class="dv">25</span>,<span class="st">"Y"</span>,<span class="st">"N"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>